var addTooltipToDoulistBtn=function(t){if(get_cookie("ck")){var o=/^https?:\/\/\w+\.douban\.com\/link2\/\?url=(\S+)$/i,i=function(t){var i=t.match(o);return i?decodeURIComponent(i[1]):t};$(document).delegate(".url-doulist-add","click",function(t){t.preventDefault();var o,e=$(this),a=i(e.data("url")),d=dui.Dialog({title:"添加到豆列",width:640,cls:"dialog-doulist dialog-tooltip-loading",content:'<div class="tooltip-text">内容加载中<i class="tooltip-loading-icon"></i></div>'}).open();d.node.find(".dui-dialog-close").click(function(t){o&&o.abort()}),o=asyncRequest(DOULIST_GET_ITEM_INFO,{url:a},"post").done(function(t){return t.r?void d.node.find(".tooltip-text").text(t.error):(t.cate=(t.kind||"")+"",t.picture="string"==typeof t.images?t.images:t.images&&t.images[0]||"",t.id=(t.id||"")+"",d.close(),void e.doulistDialog(t))}).fail(function(t){d.node.find(".tooltip-text").text("失败啦！再试一次吧")})});var e=85,a=!1,d="doulist-tooltip-hide",l=$('<div class="doulist-add-tooltip"><a class="url-doulist-add" ><i></i> 添加到豆列</a><div class="arrow"></div></div>'),n=l.find("a");l.addClass(d),l.appendTo($("body"));var s=function(t){a=setTimeout(function(){l.addClass(d)},e)};$(t).mouseenter(function(t){var o=$(this);l.css({top:o.offset().top-28,left:t.pageX-42}),n.data("url",o.attr("href")),clearTimeout(a),l.removeClass(d)}).mouseleave(s),l.mouseenter(function(){clearTimeout(a)}).mouseleave(s)}};